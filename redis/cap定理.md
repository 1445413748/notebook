### 什么是CAP

**C：Consistency**

强一致性，访问所有节点得到的数据应该完全一样。

**A：Availability**

可用性，所有节点都保持高可用。每个合理的请求都应该得到一个响应。

**P：Partiton tolerence**

分区容错，如果存在节点之间不能进行通讯，系统也可以正常提供服务。



### CAP 只能同时实现其中两种

#### 一、CA

为了同时保证一致性和高可用，A 和 B 都必须放在一个区内才行（因为网络是不可靠的），所以也就没有了分区的概念。



#### 二、CP

为了保证一致性，如果 A 更新数据， B 必须阻塞等待同步 A 中的数据，因为系统允许分区容错，所以 B 有可能一直处于阻塞状态，也就是系统失去了高可用。



#### 三、AP

AP 是目前大多数网站的选择。为了保证高可用，A 和 B 都必须在一定的时间内做出响应，因为网络存在不可靠性，不可能保证每次 A 更新数据 B 都及时同步返回，也就是说，B可能返回的是旧的数据，所以 C 不能保证。



### BASE 

1. #### 基本可用（Basically Available）

   系统在发生故障的时候，允许损失部分可用性，如搜索引擎0.5秒返回查询结果，故障后可能会2s返回。电商系统会在购物高峰时，返回降级后的页面。

2. #### 软状态（Soft-state）

   指数据可以存在中间状态，即允许系统在不同节点的数据副本之间同步数据时存在延时。如mysql或者kafka的replication。

3. #### 最终一致性（Eventually Consistent）

   最终一致性是指：经过一段时间以后，更新的数据会到达系统中的所有相关节点。这段时间就被称之为最终一致性的时间窗口。



#### Reference：

https://www.jianshu.com/p/482ba491a760

https://blog.csdn.net/zy4668/article/details/80092609